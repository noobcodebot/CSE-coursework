CREATE TABLE region (
  r_regionkey  decimal(2,0) not null,
  r_name       char(25) not null,
  r_comment    varchar(152)
);
CREATE TABLE nation (
  n_nationkey  decimal(3,0) not null,
  n_name       char(25) not null,
  n_regionkey  decimal(2,0) not null,
  n_comment    varchar(152)
);
CREATE TABLE part (
  p_partkey     decimal(10,0) not null,
  p_name        varchar(55) not null,
  p_mfgr        char(25) not null,
  p_brand       char(10) not null,
  p_type        varchar(25) not null,
  p_size        decimal(2,0) not null,
  p_container   char(10) not null,
  p_retailprice decimal(6,2) not null,
  p_comment     varchar(23) not null
);
CREATE TABLE supplier (
  s_suppkey     decimal(8,0) not null,
  s_name        char(25) not null,
  s_address     varchar(40) not null,
  s_nationkey   decimal(3,0) not null,
  s_phone       char(15) not null,
  s_acctbal     decimal(7,2) not null,
  s_comment     varchar(101) not null
);
CREATE TABLE partsupp (
  ps_partkey     decimal(10,0) not null,
  ps_suppkey     decimal(8,0) not null,
  ps_availqty    decimal(5,0) not null,
  ps_supplycost  decimal(6,2) not null,
  ps_comment     varchar(199) not null
);
CREATE TABLE customer (
  c_custkey     decimal(9,0) not null,
  c_name        varchar(25) not null,
  c_address     varchar(40) not null,
  c_nationkey   decimal(3,0) not null,
  c_phone       char(15) not null,
  c_acctbal     decimal(7,2) not null,
  c_mktsegment  char(10) not null,
  c_comment     varchar(117) not null
);
CREATE TABLE orders (
  o_orderkey       decimal(12,0) not null,
  o_custkey        decimal(9,0) not null,
  o_orderstatus    char(1) not null,
  o_totalprice     decimal(8,2) not null,
  o_orderdate      date not null,
  o_orderpriority  char(15) not null,
  o_clerk          char(15) not null,
  o_shippriority   decimal(1,0) not null,
  o_comment        varchar(79) not null
);
CREATE TABLE lineitem (
  l_orderkey    decimal(12,0) not null,
  l_partkey     decimal(10,0) not null,
  l_suppkey     decimal(8,0) not null,
  l_linenumber  decimal(1,0) not null,
  l_quantity    decimal(2,0) not null,
  l_extendedprice  decimal(8,2) not null,
  l_discount    decimal(3,2) not null,
  l_tax         decimal(3,2) not null,
  l_returnflag  char(1) not null,
  l_linestatus  char(1) not null,
  l_shipdate    date not null,
  l_commitdate  date not null,
  l_receiptdate date not null,
  l_shipinstruct char(25) not null,
  l_shipmode     char(10) not null,
  l_comment      varchar(44) not null
);
CREATE VIEW V1(c_custkey, c_name, c_address, c_phone, c_acctbal, c_mktsegment, c_comment, c_nation, c_region)
        AS
        SELECT c.c_custkey, c.c_name, c.c_address, c.c_phone, c.c_acctbal, c.c_mktsegment, c.c_comment, n.n_name, r.r_name 
        FROM Customer c 
        JOIN Nation n
        ON c.c_nationkey = n.n_nationkey
        JOIN region r
        ON n.n_regionkey = r.r_regionkey
/* V1(c_custkey,c_name,c_address,c_phone,c_acctbal,c_mktsegment,c_comment,c_nation,c_region) */;
CREATE VIEW V2(s_suppkey, s_name, s_address, s_phone, s_acctbal, s_comment, s_nation, s_region)
        AS
        SELECT s_suppkey, s_name, s_address, s_phone, s_acctbal, s_comment, n_name, r_name
        FROM supplier s 
        JOIN nation n 
        ON s.s_nationkey = n.n_nationkey
        JOIN region r 
        ON n.n_regionkey = r.r_regionkey
/* V2(s_suppkey,s_name,s_address,s_phone,s_acctbal,s_comment,s_nation,s_region) */;
CREATE VIEW V5(o_orderkey, o_custkey, o_orderstatus, o_totalprice, o_orderyear, o_orderpriority, o_clerk,
    o_shippriority, o_comment) AS
    SELECT o_orderkey, o_custkey, o_orderstatus, o_totalprice, o_orderdate, o_orderpriority, o_clerk,
    o_shippriority, o_comment from orders
/* V5(o_orderkey,o_custkey,o_orderstatus,o_totalprice,o_orderyear,o_orderpriority,o_clerk,o_shippriority,o_comment) */;
CREATE VIEW V10(p_type, min_discount, max_discount) AS
    SELECT p.p_type, MIN(l.l_discount), MAX(l.l_discount)
    FROM Part p JOIN Lineitem l 
    ON p.p_partkey = l.l_partkey
    GROUP BY p.p_type
/* V10(p_type,min_discount,max_discount) */;
CREATE VIEW V151(c_custkey, c_name, c_nationkey, c_acctbal)
        AS
        SELECT c_custkey, c_name, c_nationkey, c_acctbal
        FROM customer
        WHERE c_acctbal > 0
/* V151(c_custkey,c_name,c_nationkey,c_acctbal) */;
CREATE VIEW V152(s_suppkey, s_name, s_nationkey, s_acctbal)
        AS
        SELECT s_suppkey, s_name, s_nationkey, s_acctbal
        FROM supplier
        WHERE s_acctbal < 0
/* V152(s_suppkey,s_name,s_nationkey,s_acctbal) */;
